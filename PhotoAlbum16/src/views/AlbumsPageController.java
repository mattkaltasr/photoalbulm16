package views;

import javafx.fxml.FXML;
import javafx.fxml.FXMLLoader;

import java.io.File;
import java.io.FilenameFilter;
import java.io.IOException;
import java.nio.file.Paths;
import java.util.List;

import application.Main;
import javafx.event.ActionEvent;
import javafx.event.Event;
import javafx.event.EventHandler;
import javafx.scene.Parent;
import javafx.scene.Scene;
import javafx.scene.control.Alert;
import javafx.scene.control.Alert.AlertType;
import javafx.scene.control.Label;
import javafx.scene.input.MouseEvent;
import javafx.scene.layout.HBox;
import javafx.scene.layout.StackPane;
import javafx.scene.layout.TilePane;
import javafx.scene.paint.Color;
import javafx.scene.paint.Paint;
import javafx.scene.shape.Rectangle;
import javafx.stage.Stage;

public class AlbumsPageController {
	
	public static String currentAlbum;
	
	@FXML
	private TilePane TilePane;
	
	@FXML
	public void initialize(){
		currentAlbum = null;
		System.out.println("Albums page started");
		File folder = new File(Main.currentUser.getUserDirectory());
		String[] albums= folder.list(new FilenameFilter(){
			@Override
				public boolean accept(File current, String name){
				return new File(current,name).isDirectory();
			}
			});
		System.out.println("Albums found: " + albums.toString());
		for(int i = 0; i<albums.length; i++){

			System.out.println("Adding to Tilepane");
			Rectangle r = new Rectangle(200,200);
			Label l = new Label(albums[i]);
			l.setTextFill(Color.WHITE);
			StackPane tileStack = new StackPane(r,l);
			System.out.println(tileStack.getChildren().toString());
			
			tileStack.setOnMouseClicked(new EventHandler<MouseEvent>(){
				 Stage stage; 
			     Parent root;
				@Override
				public void handle(MouseEvent event) {				     
				stage=(Stage) tileStack.getScene().getWindow();
			    	StackPane albumTile = (StackPane) event.getSource();
			 		String albumName = ((Label) albumTile.getChildren().get(1)).getText();
			 		currentAlbum = albumName;
			    	try {
						root = FXMLLoader.load(getClass().getResource("AlbumPhotosPage.fxml"));
					     Scene scene = new Scene(root);
					     stage.setScene(scene);
					     stage.show();					
					} catch (IOException e) {
						// TODO Auto-generated catch block
						e.printStackTrace();
					}

				}
			     
			});
			TilePane.getChildren().addAll(tileStack);
		}
	}
	public void start(Stage mainStage) throws Exception {  

		//Read data from Main.currentUser.getDirectory
		
	     // obsList = FXCollections.observableList(readDataFrom(System.getProperty("user.dir") + "/data/songdata.csv"));
	      
	     // listView.setItems(obsList);
		//  listView.getSelectionModel().select(0);
	      
	   }

	@FXML
	public void AddAlbum_Clicked(ActionEvent event) {
		// TODO Autogenerated
	}
	@FXML
	public void EditAlbum_Clicked(ActionEvent event) {
		// TODO Autogenerated
	}
	
	@FXML
	public void Rectangle_Clicked(MouseEvent event) throws IOException {
		
		Rectangle btn = (Rectangle) event.getSource();		
		Color c = (Color) btn.getFill();
		String hex = String.format( "#%02X%02X%02X",
		            (int)( c.getRed() * 255 ),
		            (int)( c.getGreen() * 255 ),
		            (int)( c.getBlue() * 255 ) );
		
		Alert alert = new Alert(AlertType.INFORMATION);
		alert.setTitle("Information Dialog");
		alert.setHeaderText("Look, an Information Dialog");
		alert.setContentText("Color: " + hex);
		alert.showAndWait();
		
		 Stage stage; 
	     Parent root;     
	     
	     stage=(Stage) btn.getScene().getWindow();
	     root = FXMLLoader.load(getClass().getResource("AlbumPhotosPage.fxml"));

	     Scene scene = new Scene(root);
	     stage.setScene(scene);
	     stage.show();		
	}
	
}
